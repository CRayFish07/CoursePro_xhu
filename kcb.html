<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="js/mui.min.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<style>
			td {
				border: solid 1px #F6F6F6;
				font-size: 12px;
				text-align: center;
			}
			#kcb {
				padding: 5px;
			}
		</style>
		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a id="back" class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 id="title" class="mui-title">课程表</h1>
			<a id="refresh" class="mui-btn mui-btn-blue mui-btn-link mui-pull-right">刷新</a>
		</header>
		<div class="mui-content mui-scroll-wrapper">
			<div class="mui-scroll">
				<div id="kcb">
				</div>
			</div>
		</div>
		<script>
			mui('.mui-scroll-wrapper').scroll();
			var cookie, num;
			mui.plusReady(function() {
				cookie = plus.storage.getItem('cookie');
				num = plus.storage.getItem('num');
				getSyllabus();
			});
			document.getElementById('refresh').addEventListener('tap', function() {
				plus.nativeUI.showWaiting();
				getSyllabus(function() {
					plus.nativeUI.closeWaiting();
				});
			}, false);

			function getSyllabus(callback) {
				mui.get('http://1.xhuxm.sinaapp.com/jwxt.php?c=kbcx', {
						num: num,
						cookie: cookie
					},
					function(data) {
						if (typeof callback == 'function') {
							callback();
						}
						if (data) {
							alert(data);
							document.getElementById('kcb').innerHTML = data;
						} else {
							mui.toast('网络错误');
						}
					});
			}
		</script>
	</body>

</html>